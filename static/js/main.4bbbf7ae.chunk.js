(this.webpackJsonpwrapped2=this.webpackJsonpwrapped2||[]).push([[0],{166:function(t,e,a){"use strict";a.r(e);var s=a(95),n=a(99),i=a(12),o=a.n(i),r=a(18),l=a(27),c=a(15),p=a(16),h=a(4),d=a(19),u=a(17),g=a(21),m=a(101),f=a(9),v=a.n(f),y=a(97),b=a.n(y),j=(a(85),a(100));function x(t,e){for(var a=t.split("&"),s=0;s<a.length;s++){var n=a[s].split("=");if(decodeURIComponent(n[0])===e)return decodeURIComponent(n[1])}console.log("Query variable %s not found",e)}var O="https://sheltered-caverns-34537.herokuapp.com",k=function(t){var e=t.replace(/\([^\)]*\)/g,"");e=e.replace(/\[[^\]]*\]/g,"");var a=["official music video","music video","official mv","video","official video","official visualizer","visualizer","audio","official audio"],s=["ft."," feat","prod"];e=(e=(e=e.replace(/[^a-z0-9\xe1\xe9\xed\xf3\xfa\xf1\xfc \.,_-]/gim,"").trim()).replace(/\s\s+/g," ")).toLowerCase();for(var n=0;n<a.length;n++)e=e.replace(a[n],"");for(var i=0;i<s.length;i++)e=e.split(s[i])[0];var o=(e=e.trim()).split("-");return o=o[o.length-1].trim(),[e=(e=e.replace(/[\-+]/g,"")).replace(/\s\s+/g," "),o]};var S={damping:.1,thumbMinSize:20,renderByPixels:!("ontouchstart"in document),alwaysShowTracks:!1,continuousScrolling:!0},w={enable:!0,effect:navigator.userAgent.match(/Android/)?"glow":"bounce",damping:.2,maxOverscroll:150,glowColor:"#222a2d"},C=document.createElement("canvas"),N=C.getContext("2d");function P(t){return I.apply(this,arguments)}function I(){return(I=Object(l.a)(o.a.mark((function t(e){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,a){var s=new Image;s.crossOrigin="Anonymous",s.onload=function(){!0,N.clearRect(0,0,C.width,C.height),N.drawImage(s,0,0);var e=N.getImageData(0,0,C.width,C.height);!1;for(var a=0,n=0,i=0,o=0,r=0;r<e.data.length;r+=4){var l=e.data[r+3];o+=l,a+=e.data[r]*l,n+=e.data[r+1]*l,i+=e.data[r+2]*l}t([a/o,n/o,i/o])},s.onerror=a,s.src=e,s.crossOrigin="Anonymous"})));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var T=a(0),B=function(t){return Object(T.jsxs)("span",{className:"mergeTypeOuter","data-tooltip":t.helpText,"data-tooltip-persisten":!0,children:[Object(T.jsx)("input",{type:"radio",name:"mergeType",id:t.text,className:"mergeTypeInput",defaultChecked:!0}),Object(T.jsx)("label",{className:"mergeTypeLabel",htmlFor:t.text,onClick:function(){return t.onClick(t.type)},children:t.text})]})},E=function(t){Object(d.a)(a,t);var e=Object(u.a)(a);function a(t){var s;return Object(c.a)(this,a),(s=e.call(this,t)).logoUrls={spotify:"logos/spotify.png",download:"logos/download.png",soundcloud:"logos/soundcloud.png",youtube:"logos/youtube.png",apple:"logos/apple.svg"},s.logoMult=15,s.logoSizes={spotify:[1,1],download:[1,1],soundcloud:[1.5,1],youtube:[1.4,1],apple:[1,1]},s}return Object(p.a)(a,[{key:"render",value:function(){var t=this,e=this.logoSizes[this.props.platform],a=this.logoUrls[this.props.platform];return Object(T.jsxs)("button",{onClick:function(){return t.props.export(t.props.platform)},className:"exportButton noselect ".concat(this.props.platform,"Fill ").concat(this.props.disabled?"disabled":""),children:[Object(T.jsx)("img",{alt:"",src:a,width:"".concat(e[0]*this.logoMult),height:"".concat(e[1]*this.logoMult),className:"exportButtonIcon"}),this.props.text]})}}]),a}(v.a.Component);function H(t){return Object(T.jsx)("div",{className:"songItemExtra",children:Object(T.jsxs)("div",{className:"songItem",children:[Object(T.jsx)("img",{alt:"",src:t.img,className:"songItemImg"}),Object(T.jsx)("h3",{className:"songItemTitle",children:k(t.name)[0]}),Object(T.jsx)("p",{className:"songItemArtists",children:t.artists}),Object(T.jsx)("span",{style:{minWidth:"20px",color:t.col},children:"\u2588\u2588"})]})})}var A=function(t){Object(d.a)(a,t);var e=Object(u.a)(a);function a(t){var s;return Object(c.a)(this,a),(s=e.call(this,t)).state={included:Array(0),excluded:Array(0)},s}return Object(p.a)(a,[{key:"render",value:function(){var t=this.props.songs.map((function(t,e){if("spotify"===t.platform){var a,s;try{s=t.track.album.images[2].url}catch(i){s="/spotify-default-thumb.png"}var n=null!==(a=t.track.id)&&void 0!==a?a:e;return Object(T.jsx)(H,{name:t.track.name,img:s,artists:t.track.artists.map((function(t){return t.name})).join(", "),col:"hsl(".concat(t.hue,", ").concat(t.sat,"%, ").concat(t.val,"%)")},n.toString()+t.playlistId)}return"youtube"===t.platform?Object(T.jsx)(H,{name:t.snippet.title,img:t.snippet.thumbnails.default.url,artists:t.snippet.videoOwnerChannelTitle},t.etag):null})),e="Songs in ALL playlists",a="Songs in ONLY ONE playlist",s="Songs in ANY NUMBER of playlists";return Object(T.jsxs)("div",{className:"halfDiv",id:"songsViewContainer",children:[Object(T.jsxs)("div",{id:"songsTopBar",children:[Object(T.jsx)("div",{id:"songsTopBarInfo",children:Object(T.jsxs)("p",{id:"songsNum",children:[this.props.songs.length," Songs"]})}),Object(T.jsxs)("div",{id:"songsTopBarType",children:[Object(T.jsx)(B,{text:"Hue",type:"hue",onClick:this.props.changeSortType,helpText:e}),Object(T.jsx)(B,{text:"val",type:"val",onClick:this.props.changeSortType,helpText:a}),Object(T.jsx)(B,{text:"oangfaso",type:"rand",onClick:this.props.changeSortType,helpText:s})]})]}),Object(T.jsx)("div",{id:"songsContainer",children:Object(T.jsx)("div",{children:t})}),Object(T.jsx)("div",{id:"songsExport",children:Object(T.jsx)(E,{export:this.props.export,text:"Spotify",platform:"spotify"})})]})}},{key:"componentDidUpdate",value:function(){g.b.init(document.getElementById("songsContainer"),Object(r.a)({plugins:{overscroll:Object(r.a)({},w)}},S))}}]),a}(v.a.Component),L=a(86),z=function(t){Object(d.a)(a,t);var e=Object(u.a)(a);function a(){return Object(c.a)(this,a),e.apply(this,arguments)}return Object(p.a)(a,[{key:"render",value:function(){console.log("rendered extra");var t="0";return this.props.show?t="200px":this.props.hovering&&(t="20px"),Object(T.jsx)("div",{style:{maxHeight:t},className:"playlistItemExtra",children:Object(T.jsx)("div",{className:"playlistItemExtraInner",children:Object(T.jsx)("p",{className:"playlistItemText",children:"penis"})})})}}]),a}(v.a.Component),M=function(t){Object(d.a)(a,t);var e=Object(u.a)(a);function a(t){var s;return Object(c.a)(this,a),(s=e.call(this,t)).state={name:t.name,songsNum:"#",img:"loading.svg",extra:!1,hover:!1},s.decorate=s.decorate.bind(Object(h.a)(s)),s.toggle=s.toggle.bind(Object(h.a)(s)),"spotify"===s.props.platform&&L.get("".concat(O,"/spotify/"),{params:{endpoint:"playlists/".concat(s.props.id)}}).then(s.decorate).catch((function(t){console.log(t)})),"youtube"===s.props.platform&&L.get("".concat(O,"/youtube"),{params:{endpoint:"playlists",query:JSON.stringify({part:"snippet,contentDetails",id:s.props.id})}}).then(s.decorate).catch((function(t){console.log(t)})),s}return Object(p.a)(a,[{key:"decorate",value:function(t){console.log(t),"spotify"===this.props.platform&&(this.props.sendSongs(t.data.tracks,this.props.platform,this.props.id),this.setState({name:t.data.name,songsNum:t.data.tracks.total,img:t.data.images[0].url})),"youtube"===this.props.platform&&(this.props.sendSongs(null,this.props.platform,this.props.id),this.setState({name:t.data.items[0].snippet.title,songsNum:t.data.items[0].contentDetails.itemCount,img:t.data.items[0].snippet.thumbnails.medium.url})),this.state.name.length>30&&this.setState({name:this.state.name.slice(0,23)+"..."})}},{key:"render",value:function(){var t=this,e=function(e){t.setState({hovering:e})};return Object(T.jsxs)("div",{className:"playlistItemOuter",onClick:this.toggle,children:[Object(T.jsxs)("div",{className:"playlistItem ".concat(this.props.platform,"Border"),onMouseEnter:function(){return e(!0)},onMouseLeave:function(){return e(!1)},children:[Object(T.jsxs)("div",{className:"playlistItemMain",children:[Object(T.jsx)("img",{src:this.state.img,className:"playlistItemImage",alt:""}),Object(T.jsxs)("div",{className:"playlistItemContent",children:[Object(T.jsx)("p",{className:"playlistItemTitle",children:this.state.name}),Object(T.jsx)("p",{className:"playlistItemSongsNum",children:"".concat(this.state.songsNum," songs")})]})]}),Object(T.jsx)("div",{className:"playlistItemCloseDiv",children:Object(T.jsx)("button",{className:"playlistItemRemove",onClick:this.props.remove,children:Object(T.jsx)("img",{className:"playlistItemCloseImg",src:"close.svg"})})})]}),Object(T.jsx)(z,{hovering:this.state.hovering,show:this.state.extra,info:{data:"uhhhh"}})]})}},{key:"toggle",value:function(){console.log("toggled",this),console.log(this.state.extra,!this.state.extra),this.setState({extra:!this.state.extra})}}]),a}(v.a.Component),U=function(t){Object(d.a)(a,t);var e=Object(u.a)(a);function a(t){var s;return Object(c.a)(this,a),(s=e.call(this,t)).state={textValue:""},s.handleChange=s.handleChange.bind(Object(h.a)(s)),s.addPlaylist=s.addPlaylist.bind(Object(h.a)(s)),s.watchEnter=s.watchEnter.bind(Object(h.a)(s)),s}return Object(p.a)(a,[{key:"render",value:function(){var t=this,e=this.props.playlists.map((function(e,a){return Object(T.jsx)(M,{sendSongs:t.props.sendSongs,remove:function(){return t.props.removePlaylist(e.id,e.platform)},name:"Loading...",id:e.id,platform:e.platform},e.id+e.platform)}));this.props.highlightHelp;return Object(T.jsxs)("div",{className:"halfDiv",id:"playlistViewContainer",children:[Object(T.jsxs)("div",{id:"playlistSearchContainer",className:"",children:[Object(T.jsx)("p",{className:this.props.highlightHelp?"playlistHelpHighlight":"",id:"playlistHelp",onClick:this.props.showHelp,children:"Help"}),Object(T.jsx)("input",{id:"playlistSearch",type:"text",placeholder:"Playlist Link",value:this.state.textValue,onChange:this.handleChange,onKeyPress:this.watchEnter}),Object(T.jsx)("button",{id:"playlistAdd",type:"button",onClick:this.addPlaylist,children:"+"})]}),Object(T.jsx)("div",{id:"playlistsContainer",children:Object(T.jsx)("div",{id:"playlistsInnerContainer",children:e})})]})}},{key:"componentDidUpdate",value:function(){g.b.init(document.getElementById("playlistsContainer"),Object(r.a)({plugins:{overscroll:Object(r.a)({},w)}},S))}},{key:"parsePlaylistId",value:function(t,e){if("spotify"===e){var a=t.split("/");return a[a.length-1].split("?")[0]}if("youtube"===e){var s=new URL(t).search.substring(1);return console.log(s),x(s,"list")}}},{key:"parsePlatform",value:function(t){var e=t.split("/");return e.includes("open.spotify.com")?"spotify":e.includes("youtube.com")||e.includes("music.youtube.com")?"youtube":void 0}},{key:"addPlaylist",value:function(){var t=this.parsePlatform(this.state.textValue),e=this.parsePlaylistId(this.state.textValue,t);this.props.addPlaylist(e,t),this.setState({textValue:""})}},{key:"handleChange",value:function(t){this.setState({textValue:t.target.value})}},{key:"watchEnter",value:function(t){13===t.charCode&&this.addPlaylist()}}]),a}(v.a.Component),R=a(98),D=a.n(R),V=a(86);g.b.use(m.a);var _=function(t){Object(d.a)(a,t);var e=Object(u.a)(a);function a(t){var s;Object(c.a)(this,a),(s=e.call(this,t)).exporting=!1;var n=window.location.hash.slice(1),i=window.location.search.slice(1);(n||i)&&(console.log("set exporting"),s.export(n||i)),s.state={allSongs:{},playlists:Array(0),exporting:s.exporting,sortType:"hue",helping:!1,highlightingHelp:!1,helpPage:0};return s.interactTimeout=setTimeout((function(){console.log("highlighted help"),0===s.state.playlists.length&&!1===s.state.helping&&s.setState({highlightingHelp:!0})}),5e3),s.helpPageSelectorX=0,s.helpPageSelectorW=s.addSongs=s.addSongs.bind(Object(h.a)(s)),s.addPlaylist=s.addPlaylist.bind(Object(h.a)(s)),s.removePlaylist=s.removePlaylist.bind(Object(h.a)(s)),s.export=s.export.bind(Object(h.a)(s)),s.authorize=s.authorize.bind(Object(h.a)(s)),s}return Object(p.a)(a,[{key:"render",value:function(){var t=this,e=function(){t.setState({helping:!t.state.helping,highlightingHelp:!1})},a=[{text:"Playlist Link"},{text:"Sort Type"},{text:"Exporting"}].map((function(e,a){var s="helpPlatformBarItem noselect ";return a===t.state.helpPage&&(s+="helpPlatformBarButtonSelected"),Object(T.jsx)("span",{className:s,onClick:function(e){return function(e,a){t.helpPageSelectorW=e.target.offsetWidth,t.helpPageSelectorX=e.target.offsetLeft,t.setState({helpPage:a})}(e,a)},children:e.text},a)}));return Object(T.jsxs)("div",{id:"main",children:[this.state.exporting&&Object(T.jsxs)("div",{id:"exportOverlayOuter",children:[Object(T.jsx)("div",{id:"darkOverlayBackground"}),Object(T.jsx)("div",{id:"darkOverlay",children:Object(T.jsxs)("h2",{id:"exportingTitle",children:["Exporting ",this.state.allSongs.length," song(s) to ",this.state.exporting]})})]}),Object(T.jsxs)("div",{id:"helpOverlayOuter",children:[Object(T.jsx)("div",{id:"darkOverlayBackground",onClick:e,style:{opacity:this.state.helping?.4:0,pointerEvents:this.state.helping?"auto":"none"}}),Object(T.jsxs)("div",{id:"darkOverlay",style:{transform:this.state.helping?"translate(-50%, -50%)":"translate(-50%, -180%)",pointerEvents:this.state.helping?"auto":"none"},children:[Object(T.jsxs)("span",{id:"helpPlatformBar",children:[a,Object(T.jsx)("div",{id:"helpPlatformBarSelector",style:{left:this.helpPageSelectorX+"px",width:this.helpPageSelectorW+"px"}})]}),Object(T.jsx)("div",{id:"helpOverlayContent",children:Object(T.jsx)("h1",{id:"helpingTitle",children:"To get "})})]})]}),Object(T.jsx)("header",{}),Object(T.jsxs)("div",{id:"content",children:[Object(T.jsx)(U,{addPlaylist:this.addPlaylist,sendSongs:this.addSongs,playlists:this.state.playlists,removePlaylist:this.removePlaylist,showHelp:e,highlightHelp:this.state.highlightingHelp}),Object(T.jsx)(A,{songs:this.sortSongs(this.state.allSongs,this.state.sortType),export:this.authorize,changeSortType:function(e){t.setState({sortType:e})}}),Object(T.jsx)("hr",{id:"midBreak"})]})]})}},{key:"addSongs",value:function(){var t=Object(l.a)(o.a.mark((function t(e,a,s){var n,i,l,c,p,h;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log(e),!e){t.next=12;break}return console.log("had prev res"),n=e.items.map((function(t,e){return Object.assign(t,{playlistId:s,platform:a})})),t.next=6,this.addColours(n);case 6:i=a.toString()+s.toString(),l=Object(r.a)({},this.state.allSongs),console.log(this.state.allSongs),console.log(l),l[i]=i in l?l[i].concat(n):n,this.setState({allSongs:l});case 12:if("spotify"!==a){t.next=29;break}if(c="".concat(O,"/spotify/"),!e){t.next=23;break}if(null==e.next){t.next=19;break}p=e.next.split("v1/")[1],t.next=21;break;case 19:return console.log("reached end of playlist"),t.abrupt("return");case 21:t.next=24;break;case 23:p="playlists/".concat(s,"/tracks/?offset=0&limit=100");case 24:return t.next=26,V.get(c,{params:{endpoint:p}});case 26:return h=t.sent,t.next=29,this.addSongs(h.data,a,s);case 29:return t.abrupt("return",this.state.allSongs);case 30:case"end":return t.stop()}}),t,this)})));return function(e,a,s){return t.apply(this,arguments)}}()},{key:"addPlaylist",value:function(t,e){var a=this.state.playlists.concat({id:t,platform:e});this.setState({playlists:a,highlightingHelp:!1})}},{key:"removePlaylist",value:function(t,e){var a=this.state.playlists.length,s=Object(n.a)(this.state.playlists);if(s.filter((function(a){return a.id!=t||a.platform!=e})),this.state.playlists.length!=a){var i=e.toString()+t.toString(),o=Object(r.a)({},this.state.allSongs);delete o[i],console.log(o.length),this.setState({playlists:s,allSongs:o})}else console.log("invalid id to remove")}},{key:"authorize",value:function(t){console.log(t);var e,a=new URLSearchParams(window.location.search);if(console.log(a),"spotify"===t){var s={client_id:"e9901c5f654f4f58abb0d07a723dfd30",response_type:"token",redirect_uri:window.location.origin,state:JSON.stringify({exporting:"spotify",playlists:this.state.playlists,sortType:this.state.sortType}),scope:"playlist-modify-private playlist-modify-public"},n=(e=s,"?"+Object.entries(e).map((function(t){var e=Object(j.a)(t,2),a=e[0],s=e[1];return"".concat(encodeURIComponent(a),"=").concat(encodeURIComponent(s))})).join("&"));window.location.href="https://accounts.spotify.com/authorize"+n}}},{key:"export",value:function(){var t=Object(l.a)(o.a.mark((function t(e){var a,s,n,i,r,l,c,p,h,d;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.exporting="spotify",console.log("sending spotify playlist"),a=JSON.parse(x(e,"state")),s=x(e,"access_token"),console.log(a),t.next=7,V.get("https://api.spotify.com/v1/me",{headers:{Authorization:"Bearer ".concat(s)}});case 7:return n=t.sent,i=n.data.id,console.log(n),r=null,t.prev=12,t.next=15,V({method:"post",url:"https://api.spotify.com/v1/users/".concat(i,"/playlists"),headers:{Authorization:"Bearer ".concat(s),"Content-Type":"application/json"},data:{name:"New Playlister Playlist",description:"An awsome playlist created with playlister"}});case 15:r=t.sent,console.log(r),t.next=23;break;case 19:return t.prev=19,t.t0=t.catch(12),console.log(t.t0),t.abrupt("return");case 23:l=0;case 24:if(!(l<a.playlists.length)){t.next=47;break}c=a.playlists[l],console.log(c),p=0;case 28:if(!(p<Math.ceil(c.length/100))){t.next=44;break}return h=c.slice(100*p,100*(p+1)),t.prev=31,t.next=34,V({method:"post",url:"https://api.spotify.com/v1/playlists/".concat(r.data.id,"/tracks"),headers:{Authorization:"Bearer ".concat(s),"Content-Type":"application/json"},data:JSON.stringify({uris:h})});case 34:d=t.sent,console.log(d),t.next=41;break;case 38:t.prev=38,t.t1=t.catch(31),console.log(t.t1);case 41:p++,t.next=28;break;case 44:l++,t.next=24;break;case 47:case"end":return t.stop()}}),t,this,[[12,19],[31,38]])})));return function(e){return t.apply(this,arguments)}}()},{key:"addColours",value:function(){var t=Object(l.a)(o.a.mark((function t(e){var a,n,i,r,l;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=Object(s.a)(e),t.prev=1,a.s();case 3:if((n=a.n()).done){t.next=23;break}if("hue"in(i=n.value)){t.next=21;break}return r=void 0,t.prev=7,t.next=10,P(i.track.album.images[2].url);case 10:r=t.sent,t.next=16;break;case 13:t.prev=13,t.t0=t.catch(7),r=[40,40,40];case 16:l=D.a.rgb_to_hsv({r:r[0],g:r[1],b:r[2]}),i.hue=l.h,i.sat=l.s,i.val=l.v,(i.sat<10||i.val<10||i.val>90)&&(i.hue=Math.round(95-.05*i.val));case 21:t.next=3;break;case 23:t.next=28;break;case 25:t.prev=25,t.t1=t.catch(1),a.e(t.t1);case 28:return t.prev=28,a.f(),t.finish(28);case 31:case"end":return t.stop()}}),t,null,[[1,25,28,31],[7,13]])})));return function(e){return t.apply(this,arguments)}}()},{key:"sortSongs",value:function(t,e){for(var a=[],s=0,n=Object.keys(t);s<n.length;s++){var i=n[s];a=a.concat(t[i])}return"hue"===e.toLowerCase()?a.sort((function(t,e){return"hue"in t?"hue"in e?t.hue-e.hue:-1:1})):"val"===e.toLowerCase()?a.sort((function(t,e){return"val"in t?"val"in e?t.val-e.val:-1:1})):"rand"===e.toLowerCase()?function(t){for(var e=t.length-1;e>0;e--){var a=Math.floor(Math.random()*(e+1)),s=[t[a],t[e]];t[e]=s[0],t[a]=s[1]}}(a):void 0}}]),a}(v.a.Component);b.a.render(Object(T.jsx)(_,{}),document.getElementById("root"))},85:function(t,e,a){}},[[166,1,2]]]);
//# sourceMappingURL=main.4bbbf7ae.chunk.js.map