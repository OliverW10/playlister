(this.webpackJsonpwrapped2=this.webpackJsonpwrapped2||[]).push([[0],{165:function(t,e,s){"use strict";s.r(e);var a=s(100),n=s(101),i=s(43),o=s(24),l=s.n(o),r=s(20),c=s(42),p=s(12),h=s(13),d=s(3),u=s(15),g=s(14),m=s(19),f=s(99),y=s(7),b=s.n(y),j=s(97),v=s.n(j),x=(s(86),s(98));function O(t,e){for(var s=t.split("&"),a=0;a<s.length;a++){var n=s[a].split("=");if(decodeURIComponent(n[0])===e)return decodeURIComponent(n[1])}console.log("Query variable %s not found",e)}var k="https://sheltered-caverns-34537.herokuapp.com",S=function(t){var e=t.replace(/\([^\)]*\)/g,"");e=e.replace(/\[[^\]]*\]/g,"");var s=["official music video","music video","official mv","video","official video","official visualizer","visualizer","audio","official audio"],a=["ft."," feat","prod"];e=(e=(e=e.replace(/[^a-z0-9\xe1\xe9\xed\xf3\xfa\xf1\xfc \.,_-]/gim,"").trim()).replace(/\s\s+/g," ")).toLowerCase();for(var n=0;n<s.length;n++)e=e.replace(s[n],"");for(var i=0;i<a.length;i++)e=e.split(a[i])[0];var o=(e=e.trim()).split("-");return o=o[o.length-1].trim(),[e=(e=e.replace(/[\-+]/g,"")).replace(/\s\s+/g," "),o]};var w={damping:.1,thumbMinSize:20,renderByPixels:!("ontouchstart"in document),alwaysShowTracks:!1,continuousScrolling:!0},C={enable:!0,effect:navigator.userAgent.match(/Android/)?"glow":"bounce",damping:.2,maxOverscroll:150,glowColor:"#222a2d"},P=s(0),N=function(t){return Object(P.jsxs)("span",{className:"mergeTypeOuter","data-tooltip":t.helpText,"data-tooltip-persisten":!0,children:[Object(P.jsx)("input",{type:"radio",name:"mergeType",id:t.text,className:"mergeTypeInput",defaultChecked:!0}),Object(P.jsx)("label",{className:"mergeTypeLabel",htmlFor:t.text,onClick:function(){return t.onClick(t.type)},children:t.text})]})},I=function(t){Object(u.a)(s,t);var e=Object(g.a)(s);function s(t){var a;return Object(p.a)(this,s),(a=e.call(this,t)).logoUrls={spotify:"logos/spotify.png",download:"logos/download.png",soundcloud:"logos/soundcloud.png",youtube:"logos/youtube.png",apple:"logos/apple.svg"},a.logoMult=15,a.logoSizes={spotify:[1,1],download:[1,1],soundcloud:[1.5,1],youtube:[1.4,1],apple:[1,1]},a}return Object(h.a)(s,[{key:"render",value:function(){var t=this,e=this.logoSizes[this.props.platform],s=this.logoUrls[this.props.platform];return Object(P.jsxs)("button",{onClick:function(){return t.props.export(t.props.platform)},className:"exportButton noselect ".concat(this.props.platform,"Fill ").concat(this.props.disabled?"disabled":""),children:[Object(P.jsx)("img",{alt:"",src:s,width:"".concat(e[0]*this.logoMult),height:"".concat(e[1]*this.logoMult),className:"exportButtonIcon"}),this.props.text]})}}]),s}(b.a.Component),T=function(t){Object(u.a)(s,t);var e=Object(g.a)(s);function s(){return Object(p.a)(this,s),e.apply(this,arguments)}return Object(h.a)(s,[{key:"render",value:function(){return console.log("renderd songItem"),Object(P.jsx)("div",{className:"songItemExtra",children:Object(P.jsxs)("div",{className:"songItem",children:[Object(P.jsx)("img",{alt:"",src:this.props.img,className:"songItemImg"}),Object(P.jsx)("h3",{className:"songItemTitle",children:S(this.props.name)[0]}),Object(P.jsx)("p",{className:"songItemArtists",children:this.props.artists})]})})}}]),s}(b.a.Component),B=function(t){Object(u.a)(s,t);var e=Object(g.a)(s);function s(t){var a;return Object(p.a)(this,s),(a=e.call(this,t)).state={included:Array(0),excluded:Array(0)},a}return Object(h.a)(s,[{key:"render",value:function(){var t=this.props.songs.map((function(t,e){if("spotify"===t.platform){var s,a;try{a=t.track.album.images[2].url}catch(i){a="/spotify-default-thumb.png"}var n=null!==(s=t.track.id)&&void 0!==s?s:e;return Object(P.jsx)(T,{name:t.track.name,img:a,artists:t.track.artists.map((function(t){return t.name})).join(", ")},n.toString()+t.playlistId)}return"youtube"===t.platform?Object(P.jsx)(T,{name:t.snippet.title,img:t.snippet.thumbnails.default.url,artists:t.snippet.videoOwnerChannelTitle},t.etag):null})),e="Songs in ALL playlists",s="Songs in ONLY ONE playlist",a="Songs in ANY NUMBER of playlists";return Object(P.jsxs)("div",{className:"halfDiv",id:"songsViewContainer",children:[Object(P.jsxs)("div",{id:"songsTopBar",children:[Object(P.jsx)("div",{id:"songsTopBarInfo",children:Object(P.jsxs)("p",{id:"songsNum",children:[this.props.songs.length," Songs"]})}),Object(P.jsxs)("div",{id:"songsTopBarType",children:[Object(P.jsx)(N,{text:"All",type:"all",onClick:this.props.changeMergeType,helpText:e}),Object(P.jsx)(N,{text:"Only",type:"only",onClick:this.props.changeMergeType,helpText:s}),Object(P.jsx)(N,{text:"Any",type:"any",onClick:this.props.changeMergeType,helpText:a})]})]}),Object(P.jsx)("div",{id:"songsContainer",children:Object(P.jsx)("div",{children:t})}),Object(P.jsxs)("div",{id:"songsExport",children:[Object(P.jsx)(I,{export:this.props.export,text:"Spotify",platform:"spotify"}),Object(P.jsx)(I,{export:this.props.export,text:"Youtube",platform:"youtube",disabled:!0}),Object(P.jsx)(I,{export:this.props.export,text:"Apple Music",platform:"apple",disabled:!0}),Object(P.jsx)(I,{export:this.props.export,text:"Download",platform:"download",disabled:!1})]})]})}},{key:"componentDidUpdate",value:function(){m.b.init(document.getElementById("songsContainer"),Object(r.a)({plugins:{overscroll:Object(r.a)({},C)}},w))}}]),s}(b.a.Component),A=s(87),E=function(t){Object(u.a)(s,t);var e=Object(g.a)(s);function s(){return Object(p.a)(this,s),e.apply(this,arguments)}return Object(h.a)(s,[{key:"render",value:function(){console.log("rendered extra");var t="0";return this.props.show?t="200px":this.props.hovering&&(t="20px"),Object(P.jsx)("div",{style:{maxHeight:t},className:"playlistItemExtra",children:Object(P.jsx)("div",{className:"playlistItemExtraInner",children:Object(P.jsx)("p",{className:"playlistItemText",children:"penis"})})})}}]),s}(b.a.Component),H=function(t){Object(u.a)(s,t);var e=Object(g.a)(s);function s(t){var a;return Object(p.a)(this,s),(a=e.call(this,t)).state={name:t.name,songsNum:"#",img:"loading.svg",extra:!1,hover:!1},a.decorate=a.decorate.bind(Object(d.a)(a)),a.toggle=a.toggle.bind(Object(d.a)(a)),"spotify"===a.props.platform&&A.get("".concat(k,"/spotify/"),{params:{endpoint:"playlists/".concat(a.props.id)}}).then(a.decorate).catch((function(t){console.log(t)})),"youtube"===a.props.platform&&A.get("".concat(k,"/youtube"),{params:{endpoint:"playlists",query:JSON.stringify({part:"snippet,contentDetails",id:a.props.id})}}).then(a.decorate).catch((function(t){console.log(t)})),a}return Object(h.a)(s,[{key:"decorate",value:function(t){console.log(t),"spotify"===this.props.platform&&(this.props.sendSongs(t.data.tracks,this.props.platform,this.props.id),this.setState({name:t.data.name,songsNum:t.data.tracks.total,img:t.data.images[0].url})),"youtube"===this.props.platform&&(this.props.sendSongs(null,this.props.platform,this.props.id),this.setState({name:t.data.items[0].snippet.title,songsNum:t.data.items[0].contentDetails.itemCount,img:t.data.items[0].snippet.thumbnails.medium.url})),this.state.name.length>30&&this.setState({name:this.state.name.slice(0,23)+"..."})}},{key:"render",value:function(){var t=this,e=function(e){t.setState({hovering:e})};return Object(P.jsxs)("div",{className:"playlistItemOuter",onClick:this.toggle,children:[Object(P.jsxs)("div",{className:"playlistItem ".concat(this.props.platform,"Border"),onMouseEnter:function(){return e(!0)},onMouseLeave:function(){return e(!1)},children:[Object(P.jsxs)("div",{className:"playlistItemMain",children:[Object(P.jsx)("img",{src:this.state.img,className:"playlistItemImage",alt:""}),Object(P.jsxs)("div",{className:"playlistItemContent",children:[Object(P.jsx)("p",{className:"playlistItemTitle",children:this.state.name}),Object(P.jsx)("p",{className:"playlistItemSongsNum",children:"".concat(this.state.songsNum," songs")})]})]}),Object(P.jsx)("div",{className:"playlistItemCloseDiv",children:Object(P.jsx)("button",{className:"playlistItemRemove",onClick:this.props.remove,children:Object(P.jsx)("img",{className:"playlistItemCloseImg",src:"close.svg"})})})]}),Object(P.jsx)(E,{hovering:this.state.hovering,show:this.state.extra,info:{data:"uhhhh"}})]})}},{key:"toggle",value:function(){console.log("toggled",this),console.log(this.state.extra,!this.state.extra),this.setState({extra:!this.state.extra})}}]),s}(b.a.Component),M=function(t){Object(u.a)(s,t);var e=Object(g.a)(s);function s(t){var a;return Object(p.a)(this,s),(a=e.call(this,t)).state={textValue:""},a.handleChange=a.handleChange.bind(Object(d.a)(a)),a.addPlaylist=a.addPlaylist.bind(Object(d.a)(a)),a.watchEnter=a.watchEnter.bind(Object(d.a)(a)),a}return Object(h.a)(s,[{key:"render",value:function(){var t=this,e=this.props.playlists.map((function(e,s){return Object(P.jsx)(H,{sendSongs:t.props.sendSongs,remove:function(){return t.props.removePlaylist(e.id,e.platform)},name:"Loading...",id:e.id,platform:e.platform},e.id+e.platform)}));this.props.highlightHelp;return Object(P.jsxs)("div",{className:"halfDiv",id:"playlistViewContainer",children:[Object(P.jsxs)("div",{id:"playlistSearchContainer",className:"",children:[Object(P.jsx)("p",{className:this.props.highlightHelp?"playlistHelpHighlight":"",id:"playlistHelp",onClick:this.props.showHelp,children:"Help"}),Object(P.jsx)("input",{id:"playlistSearch",type:"text",placeholder:"Playlist Link",value:this.state.textValue,onChange:this.handleChange,onKeyPress:this.watchEnter}),Object(P.jsx)("button",{id:"playlistAdd",type:"button",onClick:this.addPlaylist,children:"+"})]}),Object(P.jsx)("div",{id:"playlistsContainer",children:Object(P.jsx)("div",{id:"playlistsInnerContainer",children:e})})]})}},{key:"componentDidUpdate",value:function(){m.b.init(document.getElementById("playlistsContainer"),Object(r.a)({plugins:{overscroll:Object(r.a)({},C)}},w))}},{key:"parsePlaylistId",value:function(t,e){if("spotify"===e){var s=t.split("/");return s[s.length-1].split("?")[0]}if("youtube"===e){var a=new URL(t).search.substring(1);return console.log(a),O(a,"list")}}},{key:"parsePlatform",value:function(t){var e=t.split("/");return e.includes("open.spotify.com")?"spotify":e.includes("youtube.com")||e.includes("music.youtube.com")?"youtube":void 0}},{key:"addPlaylist",value:function(){var t=this.parsePlatform(this.state.textValue),e=this.parsePlaylistId(this.state.textValue,t);this.props.addPlaylist(e,t),this.setState({textValue:""})}},{key:"handleChange",value:function(t){this.setState({textValue:t.target.value})}},{key:"watchEnter",value:function(t){13===t.charCode&&this.addPlaylist()}}]),s}(b.a.Component),z=s(87);m.b.use(f.a);var L=function(t){Object(u.a)(s,t);var e=Object(g.a)(s);function s(t){var a;Object(p.a)(this,s),(a=e.call(this,t)).exporting=!1;var n=window.location.hash.slice(1),i=window.location.search.slice(1);(n||i)&&(console.log("set exporting"),a.export(n||i)),a.state={allSongs:{},playlists:Array(0),exporting:a.exporting,mergeType:"Any",helping:!1,highlightingHelp:!1,helpPage:0};return a.interactTimeout=setTimeout((function(){console.log("highlighted help"),0===a.state.playlists.length&&!1===a.state.helping&&a.setState({highlightingHelp:!0})}),5e3),a.helpPageSelectorX=0,a.helpPageSelectorW=a.addSongs=a.addSongs.bind(Object(d.a)(a)),a.addPlaylist=a.addPlaylist.bind(Object(d.a)(a)),a.removePlaylist=a.removePlaylist.bind(Object(d.a)(a)),a.export=a.export.bind(Object(d.a)(a)),a.authorize=a.authorize.bind(Object(d.a)(a)),a.convertPlaylist=a.convertPlaylist.bind(Object(d.a)(a)),a.convertSong=a.convertSong.bind(Object(d.a)(a)),a}return Object(h.a)(s,[{key:"render",value:function(){var t=this,e=function(){t.setState({helping:!t.state.helping,highlightingHelp:!1})},s=[{text:"Spotify"},{text:"Youtube"},{text:"Apple Music"}].map((function(e,s){var a="helpPlatformBarItem noselect ";return s==t.state.helpPage&&(a+="helpPlatformBarButtonSelected"),Object(P.jsx)("span",{className:a,onClick:function(e){return function(e,s){t.helpPageSelectorW=e.target.offsetWidth,t.helpPageSelectorX=e.target.offsetLeft,t.setState({helpPage:s})}(e,s)},children:e.text},s)}));return Object(P.jsxs)("div",{id:"main",children:[this.state.exporting&&Object(P.jsxs)("div",{id:"exportOverlayOuter",children:[Object(P.jsx)("div",{id:"darkOverlayBackground"}),Object(P.jsx)("div",{id:"darkOverlay",children:Object(P.jsxs)("h2",{id:"exportingTitle",children:["Exporting ",this.state.allSongs.length," song(s) to ",this.state.exporting]})})]}),Object(P.jsxs)("div",{id:"helpOverlayOuter",children:[Object(P.jsx)("div",{id:"darkOverlayBackground",onClick:e,style:{opacity:this.state.helping?.4:0,pointerEvents:this.state.helping?"auto":"none"}}),Object(P.jsxs)("div",{id:"darkOverlay",style:{transform:this.state.helping?"translate(-50%, -50%)":"translate(-50%, -180%)",pointerEvents:this.state.helping?"auto":"none"},children:[Object(P.jsxs)("span",{id:"helpPlatformBar",children:[s,Object(P.jsx)("div",{id:"helpPlatformBarSelector",style:{left:this.helpPageSelectorX+"px",width:this.helpPageSelectorW+"px"}})]}),Object(P.jsx)("div",{id:"helpOverlayContent",children:Object(P.jsx)("h1",{id:"helpingTitle",children:"To get "})})]})]}),Object(P.jsx)("header",{}),Object(P.jsxs)("div",{id:"content",children:[Object(P.jsx)(M,{addPlaylist:this.addPlaylist,sendSongs:this.addSongs,playlists:this.state.playlists,removePlaylist:this.removePlaylist,showHelp:e,highlightHelp:this.state.highlightingHelp}),Object(P.jsx)(B,{songs:this.filterSongs(this.state.allSongs,this.state.mergeType),export:this.authorize,changeMergeType:function(e){t.setState({mergeType:e})}}),Object(P.jsx)("hr",{id:"midBreak"})]})]})}},{key:"addSongs",value:function(){var t=Object(c.a)(l.a.mark((function t(e,s,a){var n,i,o,c,p,h,d,u;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log(e),e&&(console.log("had prev res"),n=e.items.map((function(t,e){return Object.assign(t,{playlistId:a,platform:s})})),i=s.toString()+a.toString(),(o=Object(r.a)({},this.state.allSongs))[i]=i in o?o[i].concat(n):n,this.setState({allSongs:o})),"spotify"!==s){t.next=19;break}if(c="".concat(k,"/spotify/"),!e){t.next=13;break}if(null==e.next){t.next=9;break}p=e.next.split("v1/")[1],t.next=11;break;case 9:return console.log("reached end of playlist"),t.abrupt("return");case 11:t.next=14;break;case 13:p="playlists/".concat(a,"/tracks/?offset=0&limit=100");case 14:return t.next=16,z.get(c,{params:{endpoint:p}});case 16:return h=t.sent,t.next=19,this.addSongs(h.data,s,a);case 19:if("youtube"!==s){t.next=28;break}if(d={part:"snippet",maxResults:50,playlistId:a},e&&e.nextPageToken&&(d.pageToken=e.nextPageToken),!d.pageToken&&e){t.next=28;break}return t.next=25,z.get("".concat(k,"/youtube/"),{params:{endpoint:"playlistItems",query:JSON.stringify(d)}});case 25:return u=t.sent,t.next=28,this.addSongs(u.data,s,a);case 28:return t.abrupt("return",this.state.allSongs);case 29:case"end":return t.stop()}}),t,this)})));return function(e,s,a){return t.apply(this,arguments)}}()},{key:"addPlaylist",value:function(t,e){var s=this.state.playlists.concat({id:t,platform:e});this.setState({playlists:s,highlightingHelp:!1})}},{key:"removePlaylist",value:function(t,e){for(var s=-1,o=0;o<this.state.playlists.length;o++)console.log(this.state.playlists[o],{id:t,platform:e}),this.state.playlists[o].id===t&&this.state.playlists[o].platform===e&&(console.log("found match"),s=o);if(-1!==s){var l=[].concat(Object(i.a)(this.state.playlists.slice(0,s)),Object(i.a)(this.state.playlists.slice(s+1))),r=e.toString()+t.toString(),c=this.state.allSongs,p=(c[r],Object(a.a)(c,[r].map(n.a)));console.log(p.length),this.setState({playlists:l,allSongs:p})}else console.log("invalid id to remove")}},{key:"authorize",value:function(t){console.log(t);var e,s=new URLSearchParams(window.location.search);if(console.log(s),"spotify"===t){var a={client_id:"e9901c5f654f4f58abb0d07a723dfd30",response_type:"token",redirect_uri:window.location.origin,state:JSON.stringify({exporting:"spotify",playlists:this.state.playlists,mergeType:this.state.mergeType}),scope:"playlist-modify-private playlist-modify-public"},n=(e=a,"?"+Object.entries(e).map((function(t){var e=Object(x.a)(t,2),s=e[0],a=e[1];return"".concat(encodeURIComponent(s),"=").concat(encodeURIComponent(a))})).join("&"));window.location.href="https://accounts.spotify.com/authorize"+n}}},{key:"export",value:function(){var t=Object(c.a)(l.a.mark((function t(e){var s,a,n,i,o,r,c,p,h;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!O(e,"access_token")){t.next=49;break}return this.exporting="spotify",console.log("sending spotify playlist"),s=JSON.parse(O(e,"state")),a=O(e,"access_token"),console.log(s),t.next=8,z.get("https://api.spotify.com/v1/me",{headers:{Authorization:"Bearer ".concat(a)}});case 8:return n=t.sent,console.log(n),i=null,t.prev=12,t.next=15,z({method:"post",url:"https://api.spotify.com/v1/users/".concat(n.data.id,"/playlists"),headers:{Authorization:"Bearer ".concat(a),"Content-Type":"application/json"},data:{name:"New Playlister Playlist",description:"An awsome playlist created with playlister"}});case 15:i=t.sent,console.log(i),t.next=23;break;case 19:return t.prev=19,t.t0=t.catch(12),console.log(t.t0),t.abrupt("return");case 23:o=0;case 24:if(!(o<s.playlists.length)){t.next=49;break}return t.next=27,this.convertPlaylist(s.playlists[o],"spotify");case 27:r=t.sent,console.log(r),c=0;case 30:if(!(c<Math.ceil(r.length/100))){t.next=46;break}return p=r.slice(100*c,100*(c+1)),t.prev=33,t.next=36,z({method:"post",url:"https://api.spotify.com/v1/playlists/".concat(i.data.id,"/tracks"),headers:{Authorization:"Bearer ".concat(a),"Content-Type":"application/json"},data:JSON.stringify({uris:p})});case 36:h=t.sent,console.log(h),t.next=43;break;case 40:t.prev=40,t.t1=t.catch(33),console.log(t.t1);case 43:c++,t.next=30;break;case 46:o++,t.next=24;break;case 49:case"end":return t.stop()}}),t,this,[[12,19],[33,40]])})));return function(e){return t.apply(this,arguments)}}()},{key:"convertPlaylist",value:function(){var t=Object(c.a)(l.a.mark((function t(e,s){var a,n,i,o,r,c,p=this;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("converting ".concat(e.id," from ").concat(e.platform," to ").concat(s)),t.next=3,this.addSongs(null,e.platform,e.id);case 3:return a=this.state.allSongs,console.log(a),n=a.filter((function(t){return t.playlistId===e.id&&t.platform===e.platform})),console.log(n),i=n.map((function(t){return p.convertSong(t,s).catch((function(t){return t}))})),t.next=10,Promise.all(i);case 10:for(o=t.sent,console.log(o),r=[],c=0;c<o.length;c++)try{"spotify"===s&&r.push(o[c].track.uri)}catch(l){console.log(l),console.log("Could add #".concat(c," ").concat(n[c]))}return t.abrupt("return",r);case 15:case"end":return t.stop()}}),t,this)})));return function(e,s){return t.apply(this,arguments)}}()},{key:"convertSong",value:function(t,e){if("spotify"===e){if(t.platform===e)return new Promise((function(e,s){e(t)}));if("youtube"===t.platform){var s=S(t.snippet.title)[0].replace(/\s/g,"+");return z.get("".concat(k,"/spotify/"),{params:{endpoint:"search?q=".concat(s,"&type=track&limit=1")}}).then((function(t){return t.data.tracks.items[0].track}))}}throw new Error("Not implimted")}},{key:"filterSongs",value:function(t,e){var s=e.toLowerCase(),a=function(t){return"spotify"===t.platform?t.track.id:"youtube"===t.platform?t.etag:void 0};if("all"===s){var n=function(){console.log("filtering all");var e=[];for(var s in t)e=e.concat(t[s]);var n=e.map(a),o=Object(i.a)(new Set(n));console.log(o);for(var l,r=[],c=0;c<o.length;c++)l=o[c],n.filter((function(t){return t===l})).length>=Object.keys(t).length&&r.push(l);console.log(r);for(var p=[],h=0;h<r.length;h++)for(var d=0;d<e.length;d++){var u=e[d];if(a(u)===r[h]){p.push(u);break}}return console.log(p),{v:p}}();if("object"===typeof n)return n.v}if("only"===s)return console.log("filtering only"),[];console.log("filtering any");var o=[];for(var l in t)o=o.concat(t[l]);return o}}]),s}(b.a.Component);v.a.render(Object(P.jsx)(L,{}),document.getElementById("root"))},86:function(t,e,s){}},[[165,1,2]]]);
//# sourceMappingURL=main.899c1bd9.chunk.js.map