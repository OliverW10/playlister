(this.webpackJsonpwrapped2=this.webpackJsonpwrapped2||[]).push([[0],{165:function(t,e,s){"use strict";s.r(e);var a=s(100),n=s(101),o=s(43),i=s(24),r=s.n(i),l=s(20),c=s(42),p=s(12),d=s(13),u=s(3),h=s(15),g=s(14),m=s(19),y=s(99),f=s(7),b=s.n(f),j=s(97),v=s.n(j),x=(s(86),s(98));function O(t,e){for(var s=t.split("&"),a=0;a<s.length;a++){var n=s[a].split("=");if(decodeURIComponent(n[0])===e)return decodeURIComponent(n[1])}console.log("Query variable %s not found",e)}var k="https://sheltered-caverns-34537.herokuapp.com",S=function(t){var e=t.replace(/\([^\)]*\)/g,"");e=e.replace(/\[[^\]]*\]/g,"");var s=["official music video","music video","official mv","video","official video","official visualizer","visualizer","audio","official audio"],a=["ft."," feat","prod"];e=(e=(e=e.replace(/[^a-z0-9\xe1\xe9\xed\xf3\xfa\xf1\xfc \.,_-]/gim,"").trim()).replace(/\s\s+/g," ")).toLowerCase();for(var n=0;n<s.length;n++)e=e.replace(s[n],"");for(var o=0;o<a.length;o++)e=e.split(a[o])[0];var i=(e=e.trim()).split("-");return i=i[i.length-1].trim(),[e=(e=e.replace(/[\-+]/g,"")).replace(/\s\s+/g," "),i]};var w={damping:.1,thumbMinSize:20,renderByPixels:!("ontouchstart"in document),alwaysShowTracks:!1,continuousScrolling:!0},C={enable:!0,effect:navigator.userAgent.match(/Android/)?"glow":"bounce",damping:.2,maxOverscroll:150,glowColor:"#222a2d"},N=s(0),I=function(t){return Object(N.jsxs)("span",{className:"mergeTypeOuter","data-tooltip":t.helpText,"data-tooltip-persisten":!0,children:[Object(N.jsx)("input",{type:"radio",name:"mergeType",id:t.text,className:"mergeTypeInput",defaultChecked:!0}),Object(N.jsx)("label",{className:"mergeTypeLabel",htmlFor:t.text,onClick:function(){return t.onClick(t.type)},children:t.text})]})},P=function(t){Object(h.a)(s,t);var e=Object(g.a)(s);function s(t){var a;return Object(p.a)(this,s),(a=e.call(this,t)).logoUrls={spotify:"/logos/spotify.png",download:"/logos/download.png",soundcloud:"/logos/soundcloud.png",youtube:"/logos/youtube.png",apple:"/logos/apple.svg"},a.logoMult=15,a.logoSizes={spotify:[1,1],download:[1,1],soundcloud:[1.5,1],youtube:[1.4,1],apple:[1,1]},a}return Object(d.a)(s,[{key:"render",value:function(){var t=this,e=this.logoSizes[this.props.platform],s=this.logoUrls[this.props.platform];return Object(N.jsxs)("button",{onClick:function(){return t.props.export(t.props.platform)},className:"exportButton noselect ".concat(this.props.platform,"Fill ").concat(this.props.disabled?"disabled":""),children:[Object(N.jsx)("img",{alt:"",src:s,width:"".concat(e[0]*this.logoMult),height:"".concat(e[1]*this.logoMult),className:"exportButtonIcon"}),this.props.text]})}}]),s}(b.a.Component),T=function(t){Object(h.a)(s,t);var e=Object(g.a)(s);function s(){return Object(p.a)(this,s),e.apply(this,arguments)}return Object(d.a)(s,[{key:"render",value:function(){return console.log("renderd songItem"),Object(N.jsxs)("div",{className:"songItem",children:[Object(N.jsx)("img",{alt:"",src:this.props.img,className:"songItemImg"}),Object(N.jsx)("h3",{className:"songItemTitle",children:S(this.props.name)[0]}),Object(N.jsx)("p",{className:"songItemArtists",children:this.props.artists})]})}}]),s}(b.a.Component),A=function(t){Object(h.a)(s,t);var e=Object(g.a)(s);function s(t){var a;return Object(p.a)(this,s),(a=e.call(this,t)).state={included:Array(0),excluded:Array(0)},a}return Object(d.a)(s,[{key:"render",value:function(){var t=this.props.songs.map((function(t,e){if("spotify"===t.platform){var s,a;try{a=t.track.album.images[2].url}catch(o){a="/spotify-default-thumb.png"}var n=null!==(s=t.track.id)&&void 0!==s?s:e;return Object(N.jsx)(T,{name:t.track.name,img:a,artists:t.track.artists.map((function(t){return t.name})).join(", ")},n.toString()+t.playlistId)}return"youtube"===t.platform?Object(N.jsx)(T,{name:t.snippet.title,img:t.snippet.thumbnails.default.url,artists:t.snippet.videoOwnerChannelTitle},t.etag):null})),e="Songs in ALL playlists",s="Songs in ONLY ONE playlist",a="Songs in ANY NUMBER of playlists";return Object(N.jsxs)("div",{className:"halfDiv",id:"songsViewContainer",children:[Object(N.jsxs)("div",{id:"songsTopBar",children:[Object(N.jsx)("div",{id:"songsTopBarInfo",children:Object(N.jsxs)("p",{id:"songsNum",children:[this.props.songs.length," Songs"]})}),Object(N.jsxs)("div",{id:"songsTopBarType",children:[Object(N.jsx)(I,{text:"All",type:"all",onClick:this.props.changeMergeType,helpText:e}),Object(N.jsx)(I,{text:"Only",type:"only",onClick:this.props.changeMergeType,helpText:s}),Object(N.jsx)(I,{text:"Any",type:"any",onClick:this.props.changeMergeType,helpText:a})]})]}),Object(N.jsx)("div",{id:"songsContainer",children:Object(N.jsx)("div",{children:t})}),Object(N.jsxs)("div",{id:"songsExport",children:[Object(N.jsx)(P,{export:this.props.export,text:"Spotify",platform:"spotify"}),Object(N.jsx)(P,{export:this.props.export,text:"Youtube",platform:"youtube",disabled:!0}),Object(N.jsx)(P,{export:this.props.export,text:"Apple Music",platform:"apple",disabled:!0}),Object(N.jsx)(P,{export:this.props.export,text:"Download",platform:"download",disabled:!1})]})]})}},{key:"componentDidUpdate",value:function(){console.log("added scroll"),m.b.init(document.getElementById("songsContainer"),Object(l.a)({plugins:{overscroll:Object(l.a)({},C)}},w))}}]),s}(b.a.Component),B=s(87),E=function(t){Object(h.a)(s,t);var e=Object(g.a)(s);function s(){return Object(p.a)(this,s),e.apply(this,arguments)}return Object(d.a)(s,[{key:"render",value:function(){return console.log("rendered extra"),Object(N.jsx)("div",{className:"playlistItemExtra",children:Object(N.jsx)("p",{children:"penis"})})}}]),s}(b.a.Component),z=function(t){Object(h.a)(s,t);var e=Object(g.a)(s);function s(t){var a;return Object(p.a)(this,s),(a=e.call(this,t)).state={name:t.name,songsNum:"#",img:"/loading.svg",extra:!1},a.decorate=a.decorate.bind(Object(u.a)(a)),a.toggle=a.toggle.bind(Object(u.a)(a)),"spotify"===a.props.platform&&B.get("".concat(k,"/spotify/"),{params:{endpoint:"playlists/".concat(a.props.id)}}).then(a.decorate).catch((function(t){console.log(t)})),"youtube"===a.props.platform&&B.get("".concat(k,"/youtube"),{params:{endpoint:"playlists",query:JSON.stringify({part:"snippet,contentDetails",id:a.props.id})}}).then(a.decorate).catch((function(t){console.log(t)})),a}return Object(d.a)(s,[{key:"decorate",value:function(t){console.log(t),"spotify"===this.props.platform&&(this.props.sendSongs(t.data.tracks,this.props.platform,this.props.id),this.setState({name:t.data.name,songsNum:t.data.tracks.total,img:t.data.images[0].url})),"youtube"===this.props.platform&&(this.props.sendSongs(null,this.props.platform,this.props.id),this.setState({name:t.data.items[0].snippet.title,songsNum:t.data.items[0].contentDetails.itemCount,img:t.data.items[0].snippet.thumbnails.medium.url})),this.state.name.length>30&&this.setState({name:this.state.name.slice(0,23)+"..."})}},{key:"render",value:function(){var t="";return this.state.extra&&(t=Object(N.jsx)(E,{})),Object(N.jsxs)("div",{className:"playlistItemOuter",children:[Object(N.jsxs)("div",{className:"playlistItem ".concat(this.props.platform,"Border"),onClick:this.toggle,children:[Object(N.jsxs)("div",{className:"playlistItemMain",children:[Object(N.jsx)("img",{src:this.state.img,className:"playlistItemImage",alt:""}),Object(N.jsxs)("div",{className:"playlistItemContent",children:[Object(N.jsx)("p",{className:"playlistItemTitle",children:this.state.name}),Object(N.jsx)("p",{className:"playlistItemSongsNum",children:"".concat(this.state.songsNum," songs")})]})]}),Object(N.jsx)("div",{className:"playlistItemCloseDiv",children:Object(N.jsx)("button",{className:"playlistItemRemove",onClick:this.props.remove,children:Object(N.jsx)("img",{className:"playlistItemCloseImg",src:"close.svg"})})})]}),t]})}},{key:"toggle",value:function(){console.log("toggled",this),console.log(this.state.extra,!this.state.extra);var t=!this.state.extra;this.setState({extra:t})}}]),s}(b.a.Component),M=function(t){Object(h.a)(s,t);var e=Object(g.a)(s);function s(t){var a;return Object(p.a)(this,s),(a=e.call(this,t)).state={textValue:""},a.handleChange=a.handleChange.bind(Object(u.a)(a)),a.addPlaylist=a.addPlaylist.bind(Object(u.a)(a)),a.watchEnter=a.watchEnter.bind(Object(u.a)(a)),a}return Object(d.a)(s,[{key:"render",value:function(){var t=this,e=this.props.playlists.map((function(e,s){return Object(N.jsx)(z,{sendSongs:t.props.sendSongs,remove:function(){return t.props.removePlaylist(e.id,e.platform)},name:"Loading...",id:e.id,platform:e.platform},e.id+e.platform)}));return Object(N.jsxs)("div",{className:"halfDiv",id:"playlistViewContainer",children:[Object(N.jsxs)("div",{id:"playlistSearchContainer",className:"",children:[Object(N.jsx)("p",{id:"playlistHelp",onClick:this.props.showHelp,children:"Help"}),Object(N.jsx)("input",{id:"playlistSearch",type:"text",placeholder:"Playlist Link",value:this.state.textValue,onChange:this.handleChange,onKeyPress:this.watchEnter}),Object(N.jsx)("button",{id:"playlistAdd",type:"button",onClick:this.addPlaylist,children:"+"})]}),Object(N.jsx)("div",{id:"playlistsContainer",children:Object(N.jsx)("div",{id:"playlistsInnerContainer",children:e})})]})}},{key:"componentDidUpdate",value:function(){console.log("added scroll"),m.b.init(document.getElementById("playlistsContainer"),Object(l.a)({plugins:{overscroll:Object(l.a)({},C)}},w))}},{key:"parsePlaylistId",value:function(t,e){if("spotify"===e){var s=t.split("/");return s[s.length-1].split("?")[0]}if("youtube"===e){var a=new URL(t).search.substring(1);return console.log(a),O(a,"list")}}},{key:"parsePlatform",value:function(t){var e=t.split("/");return e.includes("open.spotify.com")?"spotify":e.includes("youtube.com")||e.includes("music.youtube.com")?"youtube":void 0}},{key:"addPlaylist",value:function(){var t=this.parsePlatform(this.state.textValue),e=this.parsePlaylistId(this.state.textValue,t);this.props.addPlaylist(e,t),this.setState({textValue:""})}},{key:"handleChange",value:function(t){this.setState({textValue:t.target.value})}},{key:"watchEnter",value:function(t){13===t.charCode&&this.addPlaylist()}}]),s}(b.a.Component),U=s(87);m.b.use(y.a);var L=function(t){Object(h.a)(s,t);var e=Object(g.a)(s);function s(t){var a;Object(p.a)(this,s),(a=e.call(this,t)).exporting=!1;var n=window.location.hash.slice(1),o=window.location.search.slice(1);return(n||o)&&(console.log("set exporting"),a.export(n||o)),a.state={allSongs:{},playlists:Array(0),exporting:a.exporting,mergeType:"Any",helping:!1},a.addSongs=a.addSongs.bind(Object(u.a)(a)),a.addPlaylist=a.addPlaylist.bind(Object(u.a)(a)),a.removePlaylist=a.removePlaylist.bind(Object(u.a)(a)),a.export=a.export.bind(Object(u.a)(a)),a.authorize=a.authorize.bind(Object(u.a)(a)),a.convertPlaylist=a.convertPlaylist.bind(Object(u.a)(a)),a.convertSong=a.convertSong.bind(Object(u.a)(a)),a}return Object(d.a)(s,[{key:"render",value:function(){var t=this,e=function(){t.setState({helping:!t.state.helping})};return Object(N.jsxs)("div",{id:"main",children:[this.state.exporting&&Object(N.jsxs)("div",{id:"exportOverlayOuter",children:[Object(N.jsx)("div",{id:"darkOverlayBackground"}),Object(N.jsx)("div",{id:"darkOverlay",children:Object(N.jsxs)("h2",{id:"exportingTitle",children:["Exporting ",this.state.allSongs.length," song(s) to ",this.state.exporting]})})]}),Object(N.jsxs)("div",{id:"helpOverlayOuter",children:[Object(N.jsx)("div",{id:"darkOverlayBackground",onClick:e,style:{opacity:this.state.helping?.4:0,pointerEvents:this.state.helping?"auto":"none"}}),Object(N.jsx)("div",{id:"darkOverlay",style:{transform:this.state.helping?"translate(-50%, -50%)":"translate(-50%, -180%)",pointerEvents:this.state.helping?"auto":"none"},children:Object(N.jsx)("h1",{id:"helpingTitle",children:"To get "})})]}),Object(N.jsx)("header",{}),Object(N.jsxs)("div",{id:"content",children:[Object(N.jsx)(M,{addPlaylist:this.addPlaylist,sendSongs:this.addSongs,playlists:this.state.playlists,removePlaylist:this.removePlaylist,showHelp:e}),Object(N.jsx)(A,{songs:this.filterSongs(this.state.allSongs,this.state.mergeType),export:this.authorize,changeMergeType:function(e){t.setState({mergeType:e})}}),Object(N.jsx)("hr",{id:"midBreak"})]})]})}},{key:"addSongs",value:function(){var t=Object(c.a)(r.a.mark((function t(e,s,a){var n,o,i,c,p,d,u,h;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log(e),e&&(console.log("had prev res"),n=e.items.map((function(t,e){return Object.assign(t,{playlistId:a,platform:s})})),o=s.toString()+a.toString(),(i=Object(l.a)({},this.state.allSongs))[o]=o in i?i[o].concat(n):n,this.setState({allSongs:i})),"spotify"!==s){t.next=19;break}if(c="".concat(k,"/spotify/"),!e){t.next=13;break}if(null==e.next){t.next=9;break}p=e.next.split("v1/")[1],t.next=11;break;case 9:return console.log("reached end of playlist"),t.abrupt("return");case 11:t.next=14;break;case 13:p="playlists/".concat(a,"/tracks/?offset=0&limit=100");case 14:return t.next=16,U.get(c,{params:{endpoint:p}});case 16:return d=t.sent,t.next=19,this.addSongs(d.data,s,a);case 19:if("youtube"!==s){t.next=28;break}if(u={part:"snippet",maxResults:50,playlistId:a},e&&e.nextPageToken&&(u.pageToken=e.nextPageToken),!u.pageToken&&e){t.next=28;break}return t.next=25,U.get("".concat(k,"/youtube/"),{params:{endpoint:"playlistItems",query:JSON.stringify(u)}});case 25:return h=t.sent,t.next=28,this.addSongs(h.data,s,a);case 28:return t.abrupt("return",this.state.allSongs);case 29:case"end":return t.stop()}}),t,this)})));return function(e,s,a){return t.apply(this,arguments)}}()},{key:"addPlaylist",value:function(t,e){var s=this.state.playlists.concat({id:t,platform:e});this.setState({playlists:s})}},{key:"removePlaylist",value:function(t,e){for(var s=-1,i=0;i<this.state.playlists.length;i++)console.log(this.state.playlists[i],{id:t,platform:e}),this.state.playlists[i].id===t&&this.state.playlists[i].platform===e&&(console.log("found match"),s=i);if(-1!==s){var r=[].concat(Object(o.a)(this.state.playlists.slice(0,s)),Object(o.a)(this.state.playlists.slice(s+1))),l=e.toString()+t.toString(),c=this.state.allSongs,p=(c[l],Object(a.a)(c,[l].map(n.a)));console.log(p.length),this.setState({playlists:r,allSongs:p})}else console.log("invalid id to remove")}},{key:"authorize",value:function(t){console.log(t);var e,s=new URLSearchParams(window.location.search);if(console.log(s),"spotify"===t){var a={client_id:"e9901c5f654f4f58abb0d07a723dfd30",response_type:"token",redirect_uri:window.location.origin,state:JSON.stringify({exporting:"spotify",playlists:this.state.playlists,mergeType:this.state.mergeType}),scope:"playlist-modify-private playlist-modify-public"},n=(e=a,"?"+Object.entries(e).map((function(t){var e=Object(x.a)(t,2),s=e[0],a=e[1];return"".concat(encodeURIComponent(s),"=").concat(encodeURIComponent(a))})).join("&"));window.location.href="https://accounts.spotify.com/authorize"+n}}},{key:"export",value:function(){var t=Object(c.a)(r.a.mark((function t(e){var s,a,n,o,i,l,c,p,d;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!O(e,"access_token")){t.next=49;break}return this.exporting="spotify",console.log("sending spotify playlist"),s=JSON.parse(O(e,"state")),a=O(e,"access_token"),console.log(s),t.next=8,U.get("https://api.spotify.com/v1/me",{headers:{Authorization:"Bearer ".concat(a)}});case 8:return n=t.sent,console.log(n),o=null,t.prev=12,t.next=15,U({method:"post",url:"https://api.spotify.com/v1/users/".concat(n.data.id,"/playlists"),headers:{Authorization:"Bearer ".concat(a),"Content-Type":"application/json"},data:{name:"New Playlister Playlist",description:"An awsome playlist created with playlister"}});case 15:o=t.sent,console.log(o),t.next=23;break;case 19:return t.prev=19,t.t0=t.catch(12),console.log(t.t0),t.abrupt("return");case 23:i=0;case 24:if(!(i<s.playlists.length)){t.next=49;break}return t.next=27,this.convertPlaylist(s.playlists[i],"spotify");case 27:l=t.sent,console.log(l),c=0;case 30:if(!(c<Math.ceil(l.length/100))){t.next=46;break}return p=l.slice(100*c,100*(c+1)),t.prev=33,t.next=36,U({method:"post",url:"https://api.spotify.com/v1/playlists/".concat(o.data.id,"/tracks"),headers:{Authorization:"Bearer ".concat(a),"Content-Type":"application/json"},data:JSON.stringify({uris:p})});case 36:d=t.sent,console.log(d),t.next=43;break;case 40:t.prev=40,t.t1=t.catch(33),console.log(t.t1);case 43:c++,t.next=30;break;case 46:i++,t.next=24;break;case 49:case"end":return t.stop()}}),t,this,[[12,19],[33,40]])})));return function(e){return t.apply(this,arguments)}}()},{key:"convertPlaylist",value:function(){var t=Object(c.a)(r.a.mark((function t(e,s){var a,n,o,i,l,c,p=this;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("converting ".concat(e.id," from ").concat(e.platform," to ").concat(s)),t.next=3,this.addSongs(null,e.platform,e.id);case 3:return a=this.state.allSongs,console.log(a),n=a.filter((function(t){return t.playlistId===e.id&&t.platform===e.platform})),console.log(n),o=n.map((function(t){return p.convertSong(t,s).catch((function(t){return t}))})),t.next=10,Promise.all(o);case 10:for(i=t.sent,console.log(i),l=[],c=0;c<i.length;c++)try{"spotify"===s&&l.push(i[c].track.uri)}catch(r){console.log(r),console.log("Could add #".concat(c," ").concat(n[c]))}return t.abrupt("return",l);case 15:case"end":return t.stop()}}),t,this)})));return function(e,s){return t.apply(this,arguments)}}()},{key:"convertSong",value:function(t,e){if("spotify"===e){if(t.platform===e)return new Promise((function(e,s){e(t)}));if("youtube"===t.platform){var s=S(t.snippet.title)[0].replace(/\s/g,"+");return U.get("".concat(k,"/spotify/"),{params:{endpoint:"search?q=".concat(s,"&type=track&limit=1")}}).then((function(t){return t.data.tracks.items[0].track}))}}throw new Error("Not implimted")}},{key:"filterSongs",value:function(t,e){var s=e.toLowerCase(),a=function(t){return"spotify"===t.platform?t.track.id:"youtube"===t.platform?t.etag:void 0};if("all"===s){var n=function(){console.log("filtering all");var e=[];for(var s in t)e=e.concat(t[s]);var n=e.map(a),i=Object(o.a)(new Set(n));console.log(i);for(var r,l=[],c=0;c<i.length;c++)r=i[c],n.filter((function(t){return t===r})).length>=Object.keys(t).length&&l.push(r);console.log(l);for(var p=[],d=0;d<l.length;d++)for(var u=0;u<e.length;u++){var h=e[u];if(a(h)===l[d]){p.push(h);break}}return console.log(p),{v:p}}();if("object"===typeof n)return n.v}if("only"!==s){console.log("filtering any");var i=[];for(var r in t)i=i.concat(t[r]);return i}console.log("filtering only")}}]),s}(b.a.Component);v.a.render(Object(N.jsx)(L,{}),document.getElementById("root"))},86:function(t,e,s){}},[[165,1,2]]]);
//# sourceMappingURL=main.3561d374.chunk.js.map